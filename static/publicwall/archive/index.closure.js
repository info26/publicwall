/* Compiled by closure library -- https://developers.google.com/closure/compiler */
/* compiled from head: 11c80b3c78abcb4071a28776fe9ffefdde9dee5d */

$("#home-nav-item").addClass("active");$("#nav-logged-in").show();
function render(){$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:document.getElementsByName("csrfmiddlewaretoken")[0].value,action:"getinfo"},success:function(a){$("#content").empty();window.tz=a.tz;window.username=a.username;window.userid=a.userid;window.userPermissions=a.permissionList;window.pageRendered=1==a.pages?-1:1;posttextbox=document.createElement("textarea");posttextbox.setAttribute("class","form-control");window.userPermissions["add-post"]?posttextbox.setAttribute("placeholder",
settings.POST_PLACEHOLDER):(posttextbox.setAttribute("disabled",!0),posttextbox.setAttribute("placeholder",settings.POST_DISABLED_PLACEHOLDER));posttextbox.setAttribute("id","posttext");$("#content").append(posttextbox);window.userPermissions["add-post"]&&(postControlBox=document.createElement("div"),postControlBox.setAttribute("class","form-inline"),lockPost=genCheckbox({id:"lockPostCheckbox",text:"Locked?"}),lockPost.classList.add("mr-2"),postControlBox.appendChild(lockPost),pinPost=genCheckbox({id:"pinPostCheckbox",
text:"Pinned?"}),postControlBox.appendChild(pinPost),$("#content").append(postControlBox));postbutton=document.createElement("button");postbuttontext=document.createTextNode(settings.POST_POST_BUTTON_TEXT);postbutton.appendChild(postbuttontext);postbutton.setAttribute("class","btn btn-primary post-button");window.userPermissions["add-post"]?postbutton.setAttribute("onclick","postPost()"):(postbutton.setAttribute("data-toggle","popover"),postbutton.setAttribute("data-content",settings.CANT_POST_POPOVER_CONTENT),
postbutton.setAttribute("tabindex",0),postbutton.setAttribute("data-trigger","focus"));$("#content").append(postbutton);window.userPermissions["add-post"]||($(postbutton).popover(),postbutton.setAttribute("title",settings.CANT_POST_POPOVER_TITLE));for(post in a.posts)postele=genPostElement(a.posts[post]),$("#posts").append(postele);0==a.posts.length&&(br=document.createElement("br"),br2=document.createElement("br"),noPostsAlert=document.createElement("div"),noPostsAlert.setAttribute("class","alert alert-primary"),
noPostsAlertText=document.createTextNode(settings.NO_POSTS_ALERT_TEXT),noPostsAlert.appendChild(noPostsAlertText),noPostsAlert.setAttribute("id","no-posts-alert"),$("#content").append(br),$("#content").append(br2),$("#content").append(noPostsAlert));registerCommentHook(".showcomments")}})}
function postPost(){""==$("#posttext").val()?commons.notify({type:NOTICE_TYPES.ERROR,msg:"Your post cannot be blank! ",delay:5E3,title:"Uh oh!"}):($("no-posts-alert").hide(),$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:document.getElementsByName("csrfmiddlewaretoken")[0].value,action:"addpost",content:$("#posttext").val()},postdata:{content:$("#posttext").val()},success:function(a){gennedPost=genPostElement({id:a.id,content:this.postdata.content,pinned:!1,user:window.username,date:a.date,
comments:0});renderedPosts=$("#posts")[0].children;firstNotPinned=null;for(post=0;post<renderedPosts.length;post++)if("false"==$(renderedPosts[post]).attr("pinned")){firstNotPinned=renderedPosts[post];break}null==firstNotPinned&&$("#posts").prepend(gennedPost);$(gennedPost).insertBefore(firstNotPinned);registerCommentHook($(gennedPost).children(".showcomments"))}}))}$(function(){window.urlParams.has("loggedin")&&commons.notify({type:NOTICE_TYPES.SUCCESS,title:"You have logged in!",delay:5E3});render()});
function registerCommentHook(a){$(a).click(function(){commentBox=$("#postUnder"+$(this).attr("data-id"));"true"==commentBox.attr("loaded")?"true"==commentBox.attr("shown")?(commentBox.slideUp(settings.TOGGLE_SPEED),commentBox.attr("shown","false")):"false"==commentBox.attr("shown")&&(commentBox.slideDown(settings.TOGGLE_SPEED),commentBox.attr("shown","true")):$.ajax({type:"POST",url:"",postid:$(this).attr("data-id"),data:{csrfmiddlewaretoken:document.getElementsByName("csrfmiddlewaretoken")[0].value,
action:"getcomments",postid:$(this).attr("data-id")},success:function(a){-1!=a.more&&(moreCommentsLink=document.createElement("a"),moreCommentsLinkIcon=document.createElement("i"),moreCommentsLinkIcon.setAttribute("class","fas fa-plus-square"),moreCommentsText=document.createTextNode(" Show "+a.more+" more comments"),moreCommentsLink.appendChild(moreCommentsLinkIcon),moreCommentsLink.appendChild(moreCommentsText),$("#commentbox"+this.postid)[0].append(moreCommentsLink));for(comment in a.comments)commentElement=
genComment(a.comments[comment]),$("#commentbox"+this.postid)[0].append(commentElement);window.userPermissions["add-comment"]?(commentInputBox=document.createElement("textarea"),commentInputBox.setAttribute("class","form-control"),commentInputBox.setAttribute("id","textInput"+this.postid),a.locked?(commentInputBox.setAttribute("disabled",!0),commentInputBox.setAttribute("placeholder",settings.POST_LOCKED_PLACEHOLDER)):a.locked||commentInputBox.setAttribute("placeholder",settings.COMMENT_PLACEHOLDER),
commentSubmit=document.createElement("button"),a.locked?(commentSubmit.setAttribute("data-toggle","popover"),commentSubmit.setAttribute("data-content",settings.POST_LOCKED_POPOVER_CONTENT),commentSubmit.setAttribute("tabindex",0),commentSubmit.setAttribute("data-trigger","focus")):a.locked||commentSubmit.setAttribute("onclick","postComment(this)"),commentSubmitText=document.createTextNode(settings.CREATE_COMMENT_TEXT),commentSubmit.appendChild(commentSubmitText),commentSubmit.setAttribute("class",
"btn btn-primary comment-button"),commentSubmit.setAttribute("data-post-id",this.postid),$("#controlsbox"+this.postid)[0].appendChild(commentInputBox),$("#controlsbox"+this.postid)[0].appendChild(commentSubmit)):(noPermission=document.createElement("i"),noPermissionText=document.createTextNode(settings.CANT_COMMENT_TEXT),noPermission.appendChild(noPermissionText),noPermission.setAttribute("class","text-muted"),$("#controlsbox"+this.postid)[0].appendChild(noPermission));$("#postUnder"+this.postid).slideDown(settings.TOGGLE_SPEED);
$("#postUnder"+this.postid).attr("shown","true");$("#postUnder"+this.postid).attr("loaded","true");a.locked&&window.userPermissions["add-comment"]&&($(commentSubmit).popover(),commentSubmit.setAttribute("title",settings.POST_LOCKED_POPOVER_TITLE))}})})}
function postComment(a){postId=parseInt($(a).attr("data-post-id"));text=$("#textInput"+postId).val();id=0;""==text?commons.notify({type:NOTICE_TYPES.ERROR,msg:"Your post cannot be blank!",title:"Uh oh!",delay:5E3}):($.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:document.getElementsByName("csrfmiddlewaretoken")[0].value,action:"addcomment",postId:parseInt($(a).attr("data-post-id")),text:$("#textInput"+postId).val()},commentData:{postId:parseInt($(a).attr("data-post-id")),text:$("#textInput"+
postId).val(),date:new Date},success:function(a){commentBox=$("#commentbox"+this.commentData.postId)[0];commentBox.appendChild(genComment({id:a.id,content:this.commentData.text,date:a.date,user:window.username,authorid:window.userid}))}}),$("#textInput"+postId).val(""))}
$(window).scroll(function(){$(window).scrollTop()+$(window).height()>=$(document).height()&&-1!=window.pageRendered&&(window.pageRendered++,$.ajax({type:"POST",url:"",data:{csrfmiddlewaretoken:document.getElementsByName("csrfmiddlewaretoken")[0].value,action:"getmoreposts",page:window.pageRendered},success:function(a){0==a.more&&(window.pageRendered=-1);for(post in a.posts)postele=genPostElement(a.posts[post]),$("#posts").append(postele),registerCommentHook($(postele).children(".showcomments"))}}))});
